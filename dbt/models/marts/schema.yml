version: 2

models:
  - name: dim_country
    description: "Country dimension table with metadata and regional groupings"
    columns:
      - name: country_code
        description: "ISO3 country code (primary key)"
        tests:
          - unique
          - not_null
      - name: country_name
        description: "Official country name"
        tests:
          - not_null
      - name: continent
        tests:
          - not_null
          - accepted_values:
              values: ['Africa', 'Asia', 'Europe', 'North America', 'South America', 'Oceania', 'Antarctica']
      - name: income_group
        tests:
          - accepted_values:
              values: ['Low income', 'Lower middle income', 'Upper middle income', 'High income']

  - name: fact_macro_indicators
    description: "Wide format fact table with 56 indicators from WB, HDR, and IMF"
    columns:
      - name: country_code
        description: "ISO3 country code (foreign key to dim_country)"
        tests:
          - not_null
          - relationships:
              to: ref('dim_country')
              field: country_code
      - name: year
        description: "Calendar year"
        tests:
          - not_null
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - country_code
            - year


  - name: mart_country_indicators_wide
    description: "Wide format table with latest available value and year for each of 56 indicators. Each indicator has two columns: the value and the year when that value was recorded. NULL values indicate no data available for that country-indicator combination."
    columns:
      - name: country_code
        description: "ISO3 country code (primary key)"
        tests:
          - unique
          - not_null
      - name: country_name
        description: "Official country name"
        tests:
          - not_null
